/*

  << Wyvern Atomicizer >>

  Execute multiple transactions, in order, atomically (if any fails, all revert).

*/

pragma solidity 0.7.5;

/**
 * @title WyvernAtomicizer
 * @author Wyvern Protocol Developers
 */
library WyvernAtomicizer {

    function atomicize(
        address[] calldata addrs,
        uint256[] calldata values,
        uint256[] calldata calldataLengths,
        bytes calldata calldatas
    ) external {
        // addrs (合约的调用地址列表)
        // values (无))
        // calldataLengths(回调代码块长度 - 2 / 2)
        // calldatas(回调代码块)

        // 校验参数的列表长度是否相等
        require(
            addrs.length == values.length &&
                addrs.length == calldataLengths.length,
            "Addresses, calldata lengths, and values must match in quantity"
        );

        uint256 j = 0;
        for (uint256 i = 0; i < addrs.length; i++) {
            bytes memory cd = new bytes(calldataLengths[i]);
            for (uint256 k = 0; k < calldataLengths[i]; k++) {
                cd[k] = calldatas[j];
                j++;
            }
            (bool success, ) = addrs[i].call{value: values[i]}(cd);
            require(success, "Atomicizer subcall failed");
        }
    }
}

// 68f0bcaa00000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000018000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000003000000000000000000000000ee23285b5354a7a9847b14f5b0901ec2e21126ac000000000000000000000000ee23285b5354a7a9847b14f5b0901ec2e21126ac000000000000000000000000ee23285b5354a7a9847b14f5b0901ec2e21126ac00000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000006400000000000000000000000000000000000000000000000000000000000000840000000000000000000000000000000000000000000000000000000000000084000000000000000000000000000000000000000000000000000000000000016c23b872dd000000000000000000000000b8a5d6173c09eed80066d044dc549709c04dbab50000000000000000000000006d7a6c68becf59d39b163b61f5dcd933c2ecc13e000000000000000000000000000000000000000000000000000000000000271023b872dd000000000000000000000000b8a5d6173c09eed80066d044dc549709c04dbab50000000000000000000000006d7a6c68becf59d39b163b61f5dcd933c2ecc13e00000000000000000000000000000000000000000000000000000000000009c4000000000000000000000000000000000000000000000000000000000000000023b872dd000000000000000000000000b8a5d6173c09eed80066d044dc549709c04dbab50000000000000000000000006d7a6c68becf59d39b163b61f5dcd933c2ecc13e00000000000000000000000000000000000000000000000000000000000009c400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000